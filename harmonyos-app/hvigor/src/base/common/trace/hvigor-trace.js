"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hvigorTrace=void 0;const trace_manager_js_1=require("./trace-manager.js");class HvigorTrace{constructor(){this.data={IS_INCREMENTAL:!0,IS_DAEMON:!0,IS_PARALLEL:!0,IS_HVIGORFILE_TYPE_CHECK:!1,TASK_TIME:{},APIS:new Set}}transmitDataToManager(){trace_manager_js_1.TraceManager.trace(HvigorTrace.TRACE_KEY,this.data,()=>{delete this.data.BUILD_ID,delete this.data.ERROR_MESSAGE,this.data.TASK_TIME={},this.data.APIS.clear()})}traceTotalTime(a){this.data.TOTAL_TIME=a}traceBaseConfig(a,t,e,r){this.data.IS_INCREMENTAL=a,this.data.IS_DAEMON=t,this.data.IS_PARALLEL=e,this.data.IS_HVIGORFILE_TYPE_CHECK=r}traceBuildId(a){this.data.BUILD_ID=a}traceTaskTime(a,t,e){var r,s;let i;i=""===t?"APP":trace_manager_js_1.TraceManager.transformKey(trace_manager_js_1.TraceManager.anonymize(t));const E=a.substring(a.indexOf("@")+1),_=null!==(s=null===(r=this.data.TASK_TIME)||void 0===r?void 0:r[i])&&void 0!==s?s:{};_[E]=e,this.data.TASK_TIME&&(this.data.TASK_TIME[i]=_)}traceErrorMessage(a){var t,e;this.data.ERROR_MESSAGE=null!==(t=this.data.ERROR_MESSAGE)&&void 0!==t?t:[],this.data.ERROR_MESSAGE.push({CODE:a.code,MESSAGE:a.originMessage,SOLUTIONS:a.originSolutions,MORE_INFO:a.moreInfo,TIMESTAMP:null===(e=a.timestamp)||void 0===e?void 0:e.getTime().toString(),COMPONENTS:a.components,CHECK_MESSAGE:a.checkMessage})}insertUsedApi(a){this.data.APIS.has(a)||this.data.APIS.add(a)}traceConfigProperties(a){a=Object.entries(a).reduce((a,[t,e])=>(a[trace_manager_js_1.TraceManager.transformKey(t)]=e,a),{}),this.data.CONFIG_PROPERTIES=a}}HvigorTrace.TRACE_KEY="HVIGOR",exports.hvigorTrace=new HvigorTrace;