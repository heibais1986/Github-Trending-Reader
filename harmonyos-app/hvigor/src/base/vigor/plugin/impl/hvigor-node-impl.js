"use strict";var __decorate=this&&this.__decorate||function(e,o,t,r){var a,i=arguments.length,l=i<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,o,t,r);else for(var _=e.length-1;_>=0;_--)(a=e[_])&&(l=(i<3?a(l):i>3?a(o,t,l):a(o,t))||l);return i>3&&l&&Object.defineProperty(o,t,l),l};Object.defineProperty(exports,"__esModule",{value:!0}),exports.HvigorNodeImpl=void 0;const hvigor_file_util_1=require("../../../../common/util/hvigor-file-util"),hvigor_trace_factory_js_1=require("../../../common/trace/hvigor-trace-factory.js"),hvigor_core_js_1=require("../../../external/core/hvigor-core.js"),hvigor_log_js_1=require("../../../log/hvigor-log.js"),task_impl_js_1=require("../../task/impl/task-impl.js");class HvigorNodeImpl{constructor(e){this.logger=hvigor_log_js_1.HvigorLogger.getLogger(HvigorNodeImpl.name),this.allSubNodes=[],this.node=e,this.nodeDir=new hvigor_file_util_1.NormalizedFile(e.getNodeDir()),this.classKind=e.classKind,Object.freeze(this.nodeDir)}getNodeName(){return this.node.getName()}getNodePath(){return this.node.getNodeDir()}getParentNode(){return this.loadParentNode(),this.parentNode}getContext(e){return this.node.getContext(e)}getAllPluginIds(){return this.node.getAllPluginIds()}getSubNodeByName(e){return this.loadAllSubNodes(),this.allSubNodes.find(o=>o.getNodeName()===e)}getTaskByName(e){const o=this.node.getTaskByName(e);if(o)return o.getHvigorTask();this.logger.warn(`The task '${e}' cannot be found on the current node.`)}registerTask(e){return this.node.registerTask(e)}subNodes(e){this.loadAllSubNodes(),this.allSubNodes.forEach(o=>e(o))}getNodeDir(){return this.nodeDir}getConfigOpt(){return this.node.getConfigOpt()}loadParentNode(){this.parentNode=hvigor_core_js_1.hvigorCore.getParentNodeByScriptPath(this.node.getBuildFilePath())}loadAllSubNodes(){var e;this.allSubNodes=null!==(e=hvigor_core_js_1.hvigorCore.getSubNodeByScriptPath(this.node.getBuildFilePath()))&&void 0!==e?e:[]}addExtraOption(e,o){this.node.addExtraOption(e,o)}getExtraOption(e){return this.node.getExtraOption(e)}beforeNodeEvaluate(e){this.node.beforeNodeEvaluate(e)}afterNodeEvaluate(e){this.node.afterNodeEvaluate(e)}getAllTasks(){return this.node.getAllTasks().map(e=>new task_impl_js_1.TaskImpl(e))}}__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getNodeName",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getNodePath",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getParentNode",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getContext",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getAllPluginIds",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getSubNodeByName",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getTaskByName",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"registerTask",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"subNodes",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getNodeDir",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getConfigOpt",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"addExtraOption",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getExtraOption",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"beforeNodeEvaluate",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"afterNodeEvaluate",null),__decorate([hvigor_trace_factory_js_1.TrackAPI],HvigorNodeImpl.prototype,"getAllTasks",null),exports.HvigorNodeImpl=HvigorNodeImpl;