"use strict";var __decorate=this&&this.__decorate||function(e,t,o,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var _=e.length-1;_>=0;_--)(i=e[_])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateHarModuleInfo=void 0;const path_1=__importDefault(require("path")),hvigor_1=require("@ohos/hvigor"),fs_extra_1=__importDefault(require("fs-extra")),task_names_js_1=require("../common/task-names.js"),ohos_hap_task_js_1=require("../task/ohos-hap-task.js"),ohos_uitransform_optimization_js_1=require("./ohos-uitransform-optimization.js"),create_module_info_js_1=require("./create-module-info.js");class CreateHarModuleInfo extends ohos_hap_task_js_1.OhosHapTask{constructor(e){super(e,task_names_js_1.TaskNames.CommonTask.CREATE_HAR_MODULE_INFO),this.outputFile=this.pathInfo.getGenerateModuleInfoPath()}get isByteCodeHar(){return this.targetService.isByteCodeHar()}get isOhosUiTransformOptimization(){return(0,ohos_uitransform_optimization_js_1.getOhosUiTransformOptimization)(this.targetService)}taskShouldDo(){return this.targetService.isByteCodeHar()||(0,ohos_uitransform_optimization_js_1.getOhosUiTransformOptimization)(this.targetService)}beforeTask(){fs_extra_1.default.existsSync(this.outputFile)&&fs_extra_1.default.removeSync(this.outputFile)}async doTaskAction(){fs_extra_1.default.ensureDirSync(path_1.default.dirname(this.outputFile)),fs_extra_1.default.writeFileSync(this.outputFile,create_module_info_js_1.MODULE_INFO_CODE,{encoding:"utf-8"})}initTaskDepends(){}}__decorate([(0,hvigor_1.OutputFile)({isDirectory:!1})],CreateHarModuleInfo.prototype,"outputFile",void 0),__decorate([(0,hvigor_1.Input)()],CreateHarModuleInfo.prototype,"isByteCodeHar",null),__decorate([(0,hvigor_1.Input)()],CreateHarModuleInfo.prototype,"isOhosUiTransformOptimization",null),exports.CreateHarModuleInfo=CreateHarModuleInfo;