"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.moduleDependencyUtil=void 0;const module_type_enum_js_1=require("../enum/module-type-enum.js"),dependency_interface_js_1=require("../project/dependency/core/dependency-interface.js"),dependency_manager_js_1=require("../project/dependency/dependency-manager.js");class ModuleDependencyUtil{constructor(){this.pureHar=new Set}getPureHar(e,n,d,t){return 0===this.pureHar.size&&this.init(e,n,d,t),this.pureHar}init(e,n,d,t){if(n.getModuleType()!==module_type_enum_js_1.ModuleType.Entry)return;e.getDirectDependencies().filter(e=>e.isLocal()&&e.getDependencyType()===dependency_interface_js_1.DependencyType.DEPENDENCY_TYPE_HAR).forEach(e=>{var n,o,r;const c=d.getModuleModelByName(null!==(r=null===(o=null===(n=e.getModuleJsonObj())||void 0===n?void 0:n.module)||void 0===o?void 0:o.name)&&void 0!==r?r:e.getPackageName());if(c){const e=new dependency_manager_js_1.DependencyManager(t,c,d).collectAllDependencies().npmDependencies,n=e.some(e=>e.isLocal()&&e.getDependencyType()===dependency_interface_js_1.DependencyType.DEPENDENCY_TYPE_HSP);n||(this.pureHar.add(c.getName()),e.forEach(e=>{var n,d,t;this.pureHar.add(e.isLocal()&&null!==(t=null===(d=null===(n=e.getModuleJsonObj())||void 0===n?void 0:n.module)||void 0===d?void 0:d.name)&&void 0!==t?t:e.getPackageName())}))}})}}exports.moduleDependencyUtil=new ModuleDependencyUtil;